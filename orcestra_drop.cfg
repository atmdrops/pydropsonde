[MANDATORY]
data_directory = ./raw/

[OPTIONAL]
path_to_flight_ids = ./raw/
path_to_l0_files = {flight_id}/
platforms = HALO
platform_directory_names = .
product_dir = ./products/

[GLOBAL_ATTRS]
title = Dropsonde data from the ORCESTRA field campaign 2024
source = dropsondes
creator_name = Helene Gloeckner, Theresa Mieslinger, Nina Robbins
creator_email = helene.gloeckner@mpimet.mpg.de, theresa.mieslinger@mpimet.mpg.de, nina.robbins@mpimet.mpg.de
project = ORCESTRA, PERCUSION, MAESTRO
platform = HALO
references = https://github.com/atmdrops/pydropsonde
license = CC-BY-4.0

[L2_ATTRS]
featureType = profile
title = BEACH dropsonde dataset (Level 2)
keywords = ORCESTRA, BEACH, Sounding, Dropsondes, Tropics, Atmospheric Profiles, Full QC
summary = This dataset is part of the Level 2 BEACH datasets. It contains ASPEN-quality controlled dropsonde data (Level 1) from a single sonde from the ORCESTRA field campaign with additional QC flags from the [pydropsonde package](https://github.com/atmdrops/pydropsonde). Use this dataset if you need a valid time coordinate for the sonde (e.g. for fall speeds) or detailed QC information. In BEACH Level 3, all sondes are combined to a common altitude. BEACH Level 4 contains the circle products.


[L3_ATTRS]
featureType = trajectoryProfile
title = BEACH dropsonde dataset (Level 3)
keywords = ORCESTRA, BEACH, Sounding, Dropsondes, Tropics, Atmospheric Profiles, Common Altitude
summary = This dataset is the Level 3 BEACH dataset. It contains quality controlled dropsonde data from the ORCESTRA field campaign with a common altitude dimension. All thermodynamic and dynamic variables are (re-)calculated consistently within the dataset and integrated quantities such as integrated water vapour are added. As such, the Level 3 dataset is the core dataset of BEACH and should be the default for any analysis. It is based on BEACH Level 2 datasets of single sonde profiles. Aggregated QC information can be found in the `sonde_qc` variables and further details are stored in the separate Level_3_QC dataset or respective Level 2 datasets. For analyses using the time, refer to the BEACH Level 2. Circle products, like mesoscale divergence and vertical velocity can be found in BEACH Level 4.


[L4_ATTRS]
featureType = trajectoryProfile
title = BEACH dropsonde dataset (Level 4)
keywords = ORCESTRA, BEACH, Sounding, Dropsondes, Tropics, Atmospheric Profiles, Circle Products
summary = This dataset is the Level 4 BEACH dataset. It contains only the sondes that belong to a circle flight pattern during ORCESTRA. The sondes in circles were used to derive so called circle products, which describe the horizontal divergence, vertical velocity, and vorticity on the mesoscale (Bony and Stevens, 2019). Single sonde profiles were first interpolated applying the Akima-splines method before calculating circle products. All sonde profile variables have the dimension `sonde` and are stored in a ragged array structure, while all circle products have the dimension `circle`. For non-interpolated sonde data and sondes that do not belong to a circle, refer to BEACH Level 3.



[processor.Sonde.add_flight_id]
flight_template = {flight_id}

[processor.Sonde.add_level_dir]
l1_dir = ./products/Level_1/{flight_id}
l2_dir = ./products/Level_2/{flight_id}

[processor.Sonde.get_l2_filename]
l2_filename_template = PERCUSION_{id}_Level_2.zarr
[processor.Sonde.check_interim_l3]
interim_l3_filename = interim_l3_{id}_{version}.zarr

[processor.Sonde.set_alt_dim]
alt_dim=gpsalt

[processor.Gridded.get_l3_filename]
l3_filename = PERCUSION_Level_3.zarr

[processor.Gridded.get_l3_dir]
l3_dir =  ./products/Level_3

[processor.Gridded.remove_qc_from_l3]
filename=PERCUSION_Level_3_qc.zarr

[processor.Gridded.get_circle_times_from_segmentation]
yaml_file=https://orcestra-campaign.github.io/flight_segmentation/all_flights.yaml

[circles.Circle.apply_interp_na]
method = akima

[processor.Gridded.get_l4_dir] 
l4_dir =  ./products/Level_4

[processor.Gridded.get_l4_filename]
l4_filename = PERCUSION_Level_4.zarr
